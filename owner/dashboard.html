<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Owner Dashboard – JBD Mart</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    body { font-family: Inter, sans-serif; }
  </style>
</head>

<body class="bg-slate-900 text-slate-100">

<!-- TOP NAV -->
<header class="bg-slate-800 border-b border-slate-700 px-6 py-4 flex justify-between items-center">
  <div>
    <h1 class="text-xl font-bold text-yellow-400">JBD Mart · Owner Dashboard</h1>
    <p id="liveClock" class="text-sm text-slate-400"></p>
  </div>

  <div class="flex gap-3">
    <button onclick="location.href='inventory.html'" class="px-4 py-2 bg-slate-700 rounded hover:bg-slate-600">
      Inventory
    </button>
    <button onclick="location.href='orders.html'" class="px-4 py-2 bg-slate-700 rounded hover:bg-slate-600">
      Orders
    </button>
    <button onclick="downloadReport()" class="px-4 py-2 bg-slate-700 rounded hover:bg-slate-600">
      Export
    </button>
    <button onclick="logout()" class="px-4 py-2 bg-red-600 rounded hover:bg-red-500">
      Logout
    </button>
  </div>
</header>

<!-- STORE STATUS -->
<section class="max-w-7xl mx-auto px-6 mt-6">
  <div class="bg-slate-800 rounded-lg p-4 flex justify-between items-center">
    <div id="orderStatus" class="font-semibold"></div>

    <div class="flex gap-2">
      <button onclick="openOrders()" class="bg-green-600 px-4 py-2 rounded">
        Start Orders
      </button>
      <button onclick="closeOrders()" class="bg-slate-700 px-4 py-2 rounded">
        Stop Orders
      </button>
    </div>
  </div>
</section>

<!-- KPI GRID -->
<section class="max-w-7xl mx-auto px-6 mt-6 grid grid-cols-2 md:grid-cols-4 gap-4">
  <div class="bg-slate-800 p-4 rounded">
    <p class="text-sm text-slate-400">Total Orders</p>
    <p id="total" class="text-3xl font-bold">0</p>
  </div>

  <div class="bg-slate-800 p-4 rounded">
    <p class="text-sm text-slate-400">Delivered</p>
    <p id="delivered" class="text-3xl font-bold text-green-400">0</p>
  </div>

  <div class="bg-slate-800 p-4 rounded">
    <p class="text-sm text-slate-400">Declined</p>
    <p id="declined" class="text-3xl font-bold text-red-400">0</p>
  </div>

  <div class="bg-slate-800 p-4 rounded">
    <p class="text-sm text-slate-400">Pending</p>
    <p id="pending" class="text-3xl font-bold text-blue-400">0</p>
  </div>
</section>

<!-- EARNINGS -->
<section class="max-w-7xl mx-auto px-6 mt-6 grid md:grid-cols-3 gap-4">
  <div class="bg-slate-800 p-5 rounded">
    <p class="text-slate-400">Today</p>
    <p id="todayOrders" class="text-xl font-bold">0</p>
    <p id="todayMoney" class="text-green-400">₹0</p>
  </div>

  <div class="bg-slate-800 p-5 rounded">
    <p class="text-slate-400">Yesterday</p>
    <p id="yOrders" class="text-xl font-bold">0</p>
    <p id="yMoney" class="text-green-400">₹0</p>
  </div>

  <div class="bg-slate-800 p-5 rounded">
    <p class="text-slate-400">Monthly</p>
    <p id="mOrders" class="text-xl font-bold">0</p>
    <p id="mMoney" class="text-green-400">₹0</p>
  </div>
</section>

<!-- LOW STOCK TABLE -->
<section class="max-w-7xl mx-auto px-6 mt-6">
  <div class="bg-slate-800 p-4 rounded">
    <h3 class="font-semibold text-red-400 mb-3">Low Stock Items (≤ 5)</h3>

    <div class="overflow-x-auto">
      <table class="w-full text-sm border-collapse">
        <thead>
          <tr class="border-b border-slate-700 text-slate-400">
            <th class="py-2 text-left">Product</th>
            <th class="py-2 text-left">Stock Left</th>
            <th class="py-2 text-left">Status</th>
          </tr>
        </thead>
        <tbody id="lowStockList"></tbody>
      </table>
    </div>
  </div>
</section>

<!-- PROMOTIONS -->
<section class="max-w-7xl mx-auto px-6 mt-6 mb-10">
  <div class="bg-slate-800 p-4 rounded">
    <h3 class="font-semibold mb-3">Send Promotion</h3>

    <input id="promoImage" placeholder="Poster Image URL"
      class="w-full p-2 rounded text-black mb-3">

    <div class="flex gap-2">
      <button onclick="addPromo()" class="bg-yellow-400 text-black px-4 py-2 rounded">
        Add Poster
      </button>
      <button onclick="sendPromo(event)" class="bg-slate-700 px-4 py-2 rounded">
        Send Notification
      </button>
    </div>
  </div>
</section>

<script src="../js/config.js"></script>
<script src="../js/authGuard.js"></script>
<script>checkAuth("owner");</script>
<script src="../js/ownerDashboard.js"></script>

<script>
function logout(){
  localStorage.clear();
  location.href="../login.html";
}

/* LIVE CLOCK */
function startClock() {
  const clock = document.getElementById("liveClock");
  function update() {
    const now = new Date();
    clock.innerText = now.toLocaleString("en-IN", {
      weekday: "short",
      day: "2-digit",
      month: "short",
      year: "numeric",
      hour: "2-digit",
      minute: "2-digit",
      second: "2-digit"
    });
  }
  update();
  setInterval(update, 1000);
}
startClock();
</script>

</body>
</html>
